import{bt as B,bu as j,d as M,bv as U,H,bw as w,b as y,o as h,v as p,x as N,m as I,c as x,W as E,bx as F,by as O,$ as V,ag as L,aw as G,e as T,B as f,y as r,p as X,bz as Z,F as Q,bA as A,bB as J,bC as C,bD as K,f as D,a5 as R,a8 as W,bE as Y,bF as ee,aQ as te,bG as oe,bH as ae}from"./KVcqcCuv.js";function ne(u){const e=new WeakMap,g=B();function b(d,o){if(u.mode!=="popLayout")return;const s=o.offsetParent,m=s instanceof HTMLElement&&s.offsetWidth||0,i={height:o.offsetHeight||0,width:o.offsetWidth||0,top:o.offsetTop,left:o.offsetLeft,right:0};i.right=m-i.width-i.left;const a=u.anchorX==="left"?`left: ${i.left}px`:`right: ${i.right}px`;o.dataset.motionPopId||(o.dataset.motionPopId=`presence-${d.id}`);const t=o.dataset.motionPopId,l=document.createElement("style");g.value.nonce&&(l.nonce=g.value.nonce),e.set(d,l),document.head.appendChild(l),l.sheet&&l.sheet.insertRule(`
    [data-motion-pop-id="${t}"] {
      position: absolute !important;
      width: ${i.width}px !important;
      height: ${i.height}px !important;
      top: ${i.top}px !important;
      ${a} !important;
      }
      `)}function v(d,o){const s=e.get(d);s&&(e.delete(d),j.render(()=>{document.head.removeChild(s),o&&(o.dataset.motionPopId="")}))}return{addPopStyle:b,removePopStyle:v,styles:e}}const se=M({name:"AnimatePresence",inheritAttrs:!0,__name:"AnimatePresence",props:{mode:{default:"sync"},initial:{type:Boolean,default:!0},as:{},custom:{},onExitComplete:{},anchorX:{default:"left"}},setup(u){const e=u;U(e);const{addPopStyle:g,removePopStyle:b,styles:v}=ne(e);function d(a){let t=a;for(;t;){if(w.get(t))return t;t=t.firstElementChild}return null}const o=new Map;function s(a){const t=w.get(a);t&&(t.getSnapshot(t.options,!0),t.setActive("exit",!1))}H(()=>{o.forEach((a,t)=>{const l=w.get(t);l&&l.unmount(!0)}),o.clear()});function m(a,t){var l;const c=d(a),n=w.get(c);if(!n){t(),o.size===0&&((l=e.onExitComplete)==null||l.call(e));return}const z=function(P){var S,_,$,k;if(c.isConnected&&(S=P?.detail)!=null&&S.isExit){const q=n.visualElement.projection;if((_=n.options)!=null&&_.layoutId&&(($=q.currentAnimation)==null?void 0:$.state)==="running"&&!n.options.exit||n.isExiting)return;c.removeEventListener("motioncomplete",z),o.delete(c),o.size===0&&((k=e.onExitComplete)==null||k.call(e)),v.has(n)&&b(n,a),n.getSnapshot(n.options,!1),t(),c.isConnected?n.didUpdate():n.unmount(!0)}};o.set(c,!0),g(n,a),c.addEventListener("motioncomplete",z),n.setActive("exit",!0),n.getSnapshot(n.options,!1),n.didUpdate()}const i=x(()=>e.mode!=="wait"?{tag:e.as}:{mode:e.mode==="wait"?"out-in":void 0});return(a,t)=>(h(),y(E(a.mode==="wait"?F:O),I({css:!1},i.value,{appear:"",onLeave:m,onEnter:s}),{default:p(()=>[N(a.$slots,"default")]),_:3},16))}}),ie={slots:{base:"rounded-md w-full",overlay:"fixed inset-0 bg-default/75 backdrop-blur-sm will-change-opacity",content:"fixed inset-0 flex items-center justify-center cursor-zoom-out focus:outline-none",zoomedImage:"w-full h-auto max-w-[95vw] max-h-[95vh] object-contain rounded-md"},variants:{zoom:{true:"will-change-transform"},open:{true:""}},compoundVariants:[{zoom:!0,open:!1,class:"cursor-zoom-in"}]},le=["onClick"],ue=Object.assign({inheritAttrs:!1},{__name:"ProseImg",props:{src:{type:String,required:!0},alt:{type:String,required:!0},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},class:{type:null,required:!1},zoom:{type:Boolean,required:!1,default:!0},ui:{type:null,required:!1}},setup(u){const e=u,g=V(),[b,v]=L(),[d,o]=L(),s=X(!1),m=x(()=>W({extend:W(ie),...g.ui?.prose?.img||{}})({zoom:e.zoom,open:s.value})),i=x(()=>{if(e.src?.startsWith("/")&&!e.src.startsWith("//")){const t=Y(ee(te().app.baseURL));if(t!=="/"&&!e.src.startsWith(t))return oe(t,e.src)}return e.src}),a=x(()=>`${i.value}::${ae()}`);return e.zoom&&G(window,"scroll",()=>{s.value=!1}),(t,l)=>(h(),T(Q,null,[f(r(b),null,{default:p(()=>[(h(),y(E(r(A)),I({src:i.value,alt:u.alt,width:u.width,height:u.height},t.$attrs,{class:m.value.base({class:[e.ui?.base,e.class]})}),null,16,["src","alt","width","height","class"]))]),_:1}),f(r(d),null,{default:p(()=>[(h(),y(E(r(A)),I({src:i.value,alt:u.alt},t.$attrs,{class:m.value.zoomedImage({class:[e.ui?.zoomedImage]})}),null,16,["src","alt","class"]))]),_:1}),u.zoom?(h(),y(r(Z),{key:0,open:s.value,"onUpdate:open":l[0]||(l[0]=c=>s.value=c),modal:!1},{default:p(({close:c})=>[f(r(J),{"as-child":""},{default:p(()=>[f(r(C),{"layout-id":a.value,"as-child":"",transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:p(()=>[f(r(v))]),_:1},8,["layout-id"])]),_:1}),f(r(K),null,{default:p(()=>[f(r(se),null,{default:p(()=>[s.value?(h(),y(r(C),{key:0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},class:R(m.value.overlay({class:[e.ui?.overlay]}))},null,8,["class"])):D("",!0),s.value?(h(),T("div",{key:1,class:R(m.value.content({class:[e.ui?.content]})),onClick:c},[f(r(C),{"as-child":"","layout-id":a.value,transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:p(()=>[f(r(o))]),_:1},8,["layout-id"])],10,le)):D("",!0)]),_:2},1024)]),_:2},1024)]),_:1},8,["open"])):(h(),y(r(v),{key:1}))],64))}});export{ue as default};
