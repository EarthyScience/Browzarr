import{bt as q,bu as B,d as W,bv as j,H as M,bw as w,c as x,b as y,o as h,v as m,x as U,m as z,X as S,bx as H,by as N,$ as F,ai as k,n as O,ax as V,e as T,B as d,y as i,bz as X,F as G,a3 as A,bA as Z,bB as J,aT as K,bC as Q,bD as Y,bE as L,bF as ee,bG as E,bH as te,f as D,a6 as R}from"./C4zWJdPe.js";function ne(r){const t=new WeakMap,g=q();function b(l){if(r.mode!=="popLayout")return;const n=l.element,u=n.offsetParent,f=u instanceof HTMLElement&&u.offsetWidth||0,o={height:n.offsetHeight||0,width:n.offsetWidth||0,top:n.offsetTop,left:n.offsetLeft,right:0};o.right=f-o.width-o.left;const s=r.anchorX==="left"?`left: ${o.left}`:`right: ${o.right}`;l.element.dataset.motionPopId=l.id;const e=document.createElement("style");g.value.nonce&&(e.nonce=g.value.nonce),t.set(l,e),document.head.appendChild(e),e.sheet&&e.sheet.insertRule(`
    [data-motion-pop-id="${l.id}"] {
      position: absolute !important;
      width: ${o.width}px !important;
      height: ${o.height}px !important;
      top: ${o.top}px !important;
      ${s}px !important;
      }
      `)}function v(l){const n=t.get(l);n&&(t.delete(l),B.render(()=>{document.head.removeChild(n)}))}return{addPopStyle:b,removePopStyle:v,styles:t}}const ae=W({name:"AnimatePresence",inheritAttrs:!0,__name:"AnimatePresence",props:{mode:{default:"sync"},initial:{type:Boolean,default:!0},as:{},custom:{},onExitComplete:{},anchorX:{default:"left"}},setup(r){const t=r;j(t);const{addPopStyle:g,removePopStyle:b,styles:v}=ne(t);function l(s){let e=s;for(;e;){if(w.get(e))return e;e=e.firstElementChild}return null}const n=new Map;function u(s){const e=w.get(s);e&&(e.getSnapshot(e.options,!0),e.setActive("exit",!1))}M(()=>{n.forEach((s,e)=>{const p=w.get(e);p&&p.unmount(!0)}),n.clear()});function f(s,e){var p;const c=l(s),a=w.get(c);if(!a){e(),n.size===0&&((p=t.onExitComplete)==null||p.call(t));return}const I=function(P){var _,$;if(c.isConnected&&(_=P?.detail)!=null&&_.isExit){const C=a.visualElement.projection;if(C?.currentAnimation&&C.currentAnimation.state==="running"&&!a.options.exit||a.isExiting)return;c.removeEventListener("motioncomplete",I),n.delete(c),n.size===0&&(($=t.onExitComplete)==null||$.call(t)),v.has(a)&&b(a),a.getSnapshot(a.options,!1),e(),c.isConnected?a.didUpdate():a.unmount(!0)}};n.set(c,!0),g(a),c.addEventListener("motioncomplete",I),a.setActive("exit",!0),a.getSnapshot(a.options,!1),a.didUpdate()}const o=x(()=>t.mode!=="wait"?{tag:t.as}:{mode:t.mode==="wait"?"out-in":void 0});return(s,e)=>(h(),y(S(s.mode==="wait"?H:N),z({css:!1},o.value,{appear:"",onLeave:f,onEnter:u}),{default:m(()=>[U(s.$slots,"default")]),_:3},16))}}),oe={slots:{base:"rounded-md w-full",overlay:"fixed inset-0 bg-default/75 backdrop-blur-sm will-change-opacity",content:"fixed inset-0 flex items-center justify-center cursor-zoom-out focus:outline-none",zoomedImage:"w-full h-auto max-w-[95vw] max-h-[95vh] object-contain rounded-md"},variants:{zoom:{true:"will-change-transform"},open:{true:""}},compoundVariants:[{zoom:!0,open:!1,class:"cursor-zoom-in"}]},se=["onClick"],le=Object.assign({inheritAttrs:!1},{__name:"ProseImg",props:{src:{type:String,required:!0},alt:{type:String,required:!0},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},class:{type:null,required:!1},zoom:{type:Boolean,required:!1,default:!0},ui:{type:null,required:!1}},setup(r){const t=r,g=F(),[b,v]=k(),[l,n]=k(),u=O(!1),f=x(()=>A({extend:A(oe),...g.ui?.prose?.img||{}})({zoom:t.zoom,open:u.value})),o=x(()=>{if(t.src?.startsWith("/")&&!t.src.startsWith("//")){const e=Z(J(K().app.baseURL));if(e!=="/"&&!t.src.startsWith(e))return Q(e,t.src)}return t.src}),s=x(()=>`${o.value}::${Y()}`);return t.zoom&&V(window,"scroll",()=>{u.value=!1}),(e,p)=>(h(),T(G,null,[d(i(b),null,{default:m(()=>[(h(),y(S(i(L)),z({src:o.value,alt:r.alt,width:r.width,height:r.height},e.$attrs,{class:f.value.base({class:[t.ui?.base,t.class]})}),null,16,["src","alt","width","height","class"]))]),_:1}),d(i(l),null,{default:m(()=>[(h(),y(S(i(L)),z({src:o.value,alt:r.alt},e.$attrs,{class:f.value.zoomedImage({class:[t.ui?.zoomedImage]})}),null,16,["src","alt","class"]))]),_:1}),r.zoom?(h(),y(i(X),{key:0,open:u.value,"onUpdate:open":p[0]||(p[0]=c=>u.value=c),modal:!1},{default:m(({close:c})=>[d(i(ee),{"as-child":""},{default:m(()=>[d(i(E),{"layout-id":s.value,"as-child":"",transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:m(()=>[d(i(v))]),_:1},8,["layout-id"])]),_:1}),d(i(te),null,{default:m(()=>[d(i(ae),null,{default:m(()=>[u.value?(h(),y(i(E),{key:0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},class:R(f.value.overlay({class:[t.ui?.overlay]}))},null,8,["class"])):D("",!0),u.value?(h(),T("div",{key:1,class:R(f.value.content({class:[t.ui?.content]})),onClick:c},[d(i(E),{"as-child":"","layout-id":s.value,transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:m(()=>[d(i(n))]),_:1},8,["layout-id"])],10,se)):D("",!0)]),_:2},1024)]),_:2},1024)]),_:1},8,["open"])):(h(),y(i(v),{key:1}))],64))}});export{le as default};
