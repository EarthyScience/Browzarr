(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2786:()=>{},4394:(e,t,n)=>{Promise.resolve().then(n.bind(n,5452))},4938:(e,t,n)=>{"use strict";n.d(t,{_k:()=>s,Nw:()=>j,xn:()=>w,aW:()=>h,IE:()=>p,xP:()=>c});var r=n(2207),a=n(6023),i=n(3612),o=n(5788);let s=e=>{let{volTexture:t,shape:n,colormap:s}=e,l=(0,a.useRef)(null),{threshold:c,steps:u,flip:m,xMax:d,xMin:h,yMax:p,yMin:f,zMax:x,zMin:v}=(0,o._5)({threshold:{value:0,min:0,max:1,step:.01,label:"Clip Values"},steps:{value:200,min:50,max:1e3,step:25,label:"Quality"},flip:{value:!1,label:"Invert Values"},xMax:{value:1,min:-1,max:1,step:.01},xMin:{value:-1,min:-1,max:1,step:.01},yMax:{value:1,min:-1,max:1,step:.01},yMin:{value:-1,min:-1,max:1,step:.01},zMax:{value:1,min:-1,max:1,step:.01},zMin:{value:-1,min:-1,max:1,step:.01}}),g=new i.BKk({glslVersion:i.Wdf,uniforms:{map:{value:t},cmap:{value:s},cameraPos:{value:new i.Pq0},threshold:{value:c},scale:{value:n},flatBounds:{value:new i.IUQ(h,d,f,p)},vertBounds:{value:new i.I9Y(v,x)},steps:{value:u},flip:{value:m}},vertexShader:" // by Jeran Poehls\r\n\r\nout vec3 vOrigin;\r\nout vec3 vDirection;\r\nvarying vec2 Vuv;\r\n\r\nvoid main() {\r\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\r\n\r\n    vOrigin = vec3( inverse( modelMatrix ) * vec4( cameraPosition, 1.0 ) ).xyz;\r\n    vDirection = position - vOrigin;\r\n    Vuv = uv;\r\n    gl_Position = projectionMatrix * mvPosition;\r\n}",fragmentShader:"// by Jeran Poehls\r\nprecision highp float;\r\nprecision highp sampler3D;\r\n\r\nuniform mat4 modelViewMatrix;\r\nuniform mat4 projectionMatrix;\r\n\r\nin vec3 vOrigin;\r\nin vec3 vDirection;\r\n\r\nout vec4 color;\r\n\r\nuniform sampler3D map;\r\nuniform sampler2D cmap;\r\n\r\nuniform vec3 scale;\r\nuniform float threshold;\r\nuniform float steps;\r\nuniform bool flip;\r\nuniform vec4 flatBounds;\r\nuniform vec2 vertBounds;\r\nuniform float intensity;\r\n\r\nvec2 hitBox(vec3 orig, vec3 dir) {\r\n    vec3 box_min = vec3(-(scale * 0.5));\r\n    vec3 box_max = vec3(scale * 0.5);\r\n    vec3 inv_dir = 1.0 / dir;\r\n    vec3 tmin_tmp = (box_min - orig) * inv_dir;\r\n    vec3 tmax_tmp = (box_max - orig) * inv_dir;\r\n    vec3 tmin = min(tmin_tmp, tmax_tmp);\r\n    vec3 tmax = max(tmin_tmp, tmax_tmp);\r\n    float t0 = max(tmin.x, max(tmin.y, tmin.z));\r\n    float t1 = min(tmax.x, min(tmax.y, tmax.z));\r\n    return vec2(t0, t1);\r\n}\r\n\r\nfloat sample1( vec3 p ) {\r\n    return texture( map, p ).r;\r\n}\r\n\r\n#define epsilon 0.0001\r\n\r\nvoid main() {\r\n    vec3 rayDir = normalize(vDirection);\r\n    vec2 bounds = hitBox(vOrigin, rayDir);\r\n\r\n    if (bounds.x > bounds.y) discard;\r\n\r\n    bounds.x = max(bounds.x, 0.0);\r\n\r\n    vec3 p = vOrigin + bounds.x * rayDir;\r\n    vec3 inc = 1.0 / abs(rayDir);\r\n    float delta = min(inc.x, min(inc.y, inc.z));\r\n    delta /= steps;\r\n\r\n    vec4 accumColor = vec4(0.0);\r\n    float alphaAcc = 0.0;\r\n    for (float t = bounds.x; t < bounds.y; t += delta) {\r\n        if (p.x > -flatBounds.x || p.x < -flatBounds.y) {\r\n            p += rayDir * delta;\r\n            continue;\r\n        }\r\n        if (-p.z > -flatBounds.z || -p.z < -flatBounds.w) {\r\n            p += rayDir * delta;\r\n            continue;\r\n        }\r\n        if (p.y < vertBounds.x || p.y > vertBounds.y) {\r\n            p += rayDir * delta;\r\n            continue;\r\n        }\r\n\r\n        float d = sample1(p / scale + 0.5);\r\n\r\n        bool cond = (d > threshold) || (d == 0.0 && threshold == 0.0);\r\n        cond = flip ? !cond : cond;\r\n\r\n        if (cond) {\r\n            vec4 col = texture(cmap, vec2(d, 0.5));\r\n            // Change this later back to use intensity then delete comment. Or maybe we don't need intensity\r\n            float alpha = float(col.a > 0.);\r\n\r\n            accumColor.rgb += (1.0 - alphaAcc) * alpha * col.rgb;\r\n            alphaAcc += alpha * (1.0 - alphaAcc);\r\n\r\n            if (alphaAcc >= 1.0) break;\r\n        }\r\n\r\n        p += rayDir * delta;\r\n    }\r\n\r\n    accumColor.a = alphaAcc; // Set the final accumulated alpha\r\n    color = accumColor;\r\n    if (color.a == 0.0) discard;\r\n}\r\n",transparent:!0,blending:i.NTi,depthWrite:!1,side:i.hsX}),y=(0,a.useMemo)(()=>new i.WBB(4,8),[]);return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("mesh",{ref:l,geometry:y,children:(0,r.jsx)("primitive",{attach:"material",object:g})})})};var l=n(7430);let c=e=>{let[t,n]=(0,a.useState)(null),{setTimeSeries:i,setPlotDim:o,setDimCoords:s}=e.setters,{shape:c,ZarrDS:u,dimArrays:m,dimNames:d,dimUnits:h}=e.values;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("mesh",{scale:c,onClick:e=>{e.stopPropagation(),e.intersections.length>0&&function(e){let t=e.point,r=e.uv,a=e.normal;if(u){var c,p;u.GetTimeSeries({uv:r,normal:a}).then(e=>i(e));let e=a.toArray().map((e,t)=>Math.abs(e)>0?t:null).filter(e=>null!==e);o(2-e[0]);let t=(0,l.jT)({normal:a,uv:r}).map((e,t)=>e?m[t][Math.round(e*m[t].length)]:null),n=d.filter((e,n)=>null!==t[n]),f=h.filter((e,n)=>null!==t[n]);t=t.filter(e=>null!==e),s({first:{name:n[0],loc:null!=(c=t[0])?c:0,units:f[0]},second:{name:n[1],loc:null!=(p=t[1])?p:0,units:f[1]},plot:{units:h[2-e[0]]}})}n(t)}(e.intersections[0])},children:[(0,r.jsx)("boxGeometry",{args:[1,1,1]}),(0,r.jsx)("meshBasicMaterial",{transparent:!0,opacity:0})]}),t&&(0,r.jsxs)("mesh",{position:t,scale:.01,children:[(0,r.jsx)("boxGeometry",{}),(0,r.jsx)("meshBasicMaterial",{color:"#ff0000"})]})]})};var u=n(5735),m=n(4482);function d(e){let{points:t,pointSize:n,pointColor:o,pointSetters:s}=e,l=(0,a.useRef)(null),c=t.length,[u,d]=(0,a.useState)(!1),{setPointID:h,setPointLoc:p,setShowPointInfo:f}=s,[x,v]=(0,a.useState)(1);(0,a.useEffect)(()=>{if(l.current){let e=new i.B69;for(let n=0;n<c;n++){let r=t[n].toArray();e.position.set(...r),e.scale.set(1/x,1/x,1/x),e.updateMatrix(),l.current.setMatrixAt(n,e.matrix)}l.current.instanceMatrix.needsUpdate=!0}},[t,x]);let g=(0,a.useMemo)(()=>new i.Gu$(n),[n]),y=(0,a.useMemo)(()=>new i.V9B({color:o}),[]);return(0,m.C)(e=>{let{camera:t}=e;t.zoom!==x&&v(t.zoom)}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("mesh",{onPointerEnter:function(e){if(l.current){let t=new i.B69,n=new i.kn4;l.current.getMatrixAt(e.instanceId,n);let r=new i.Pq0;r.setFromMatrixPosition(n),t.scale.set(3/x,3/x,3/x),t.position.copy(r),t.updateMatrix(),l.current.setMatrixAt(e.instanceId,t.matrix),l.current.instanceMatrix.needsUpdate=!0,d(e=>!e),h(e.instanceId),p([e.clientX,e.clientY]),f(!0)}},onPointerLeave:function(){if(l.current){let e=new i.B69,t=new i.kn4,n=new i.Pq0;for(let r=0;r<c;r++)l.current.getMatrixAt(r,t),n.setFromMatrixPosition(t),e.scale.set(1/x,1/x,1/x),e.position.copy(n),e.updateMatrix(),l.current.setMatrixAt(r,e.matrix);l.current.instanceMatrix.needsUpdate=!0,d(e=>!e),f(!1)}},children:(0,r.jsx)("instancedMesh",{ref:l,args:[g,y,c]})})})}let h=e=>{let{lineWidth:t=5,showPoints:n=!1,pointSize:o=5,pointColor:s="#777777",interpolation:l="linear",height:c,pointSetters:m,yScale:h,xScale:p}=e,{scaling:f,timeSeries:x}=(0,a.useContext)(u.N),{maxVal:v,minVal:g,colormap:y}=f,[w,b]=(0,a.useMemo)(()=>{if(!x||0===x.length)return[[new i.Pq0(0,0,0)],[0]];let e=window.innerWidth,t=window.innerHeight-c-50,n=function(e,t,n){let r=(t-e)/(n-1);return Array.from({length:n},(t,n)=>e+r*n)}(-e*p/2,e*p/2,x.length),r=x.map(e=>(e-g)/(v-g));return[r.map((e,r)=>new i.Pq0(n[r],(e-.5)*t*h,5)),r]},[x,l,c,h,p]),S=(0,a.useMemo)(()=>{if(!x||0===x.length)return null;if("curved"===l){let e=new i.B6O(w),t=new i.LoY().setFromPoints(e.getPoints(50));return t.setAttribute("normed",new i.qtW(b.flatMap(e=>Array(50).fill(e)),1)),t}{let e=new i.LoY().setFromPoints(w);return e.setAttribute("normed",new i.qtW(b,1)),e}},[w]),j=(0,a.useMemo)(()=>new i.BKk({glslVersion:i.Wdf,uniforms:{cmap:{value:y}},vertexShader:"\n                    varying float vNormed;\n                    attribute float normed;\n\n                    void main() {\n                        vNormed = normed;\n                        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                    }\n                    ",fragmentShader:"\n                    out vec4 Color;\n                    uniform sampler2D cmap;\n                    varying float vNormed;\n\n                    void main() {\n                        vec4 texColor = texture(cmap, vec2(vNormed, 0.5));\n                        texColor.a = 2.;\n                        // Color = vec4(1.,0.0,0.,1.);\n                        Color = texColor;\n                    }\n                    ",linewidth:t,depthWrite:!1}),[t]);return x&&0!==x.length?(0,r.jsxs)("group",{children:[S&&(0,r.jsx)("primitive",{object:new i.N1A(S,j)}),n&&(0,r.jsx)(d,{points:w,pointSize:o,pointColor:s,pointSetters:m})]}):null},p=e=>{let{textures:t}=e,{texture:n,colormap:s}=t,{pointScale:l,scalePoints:c,scaleIntensity:u}=(0,o._5)({pointScale:{value:1,min:1,max:100,step:1},scalePoints:{value:!1,label:"Scale Points By Value"},scaleIntensity:{value:2,min:1,max:10,step:.2,labe:"Scale Intensity"}}),{data:m,width:d,height:h,depth:p}=(0,a.useMemo)(()=>n instanceof i.dYF?{data:n.image.data,width:n.image.width,height:n.image.height,depth:n.image.depth}:(console.warn("Provided texture is not a Data3DTexture"),{data:[],width:0,height:0,depth:0}),[n]),{positions:f,values:x}=(0,a.useMemo)(()=>{let e=[],t=[],n=d/h,r=p/h;r=r>10?10:r;for(let a=0;a<p;a++)for(let i=0;i<h;i++)for(let o=0;o<d;o++){let s=m[o+i*d+a*d*h]||0;if(s>0){let l=(o/(d-1)-.5)*n,c=i/(h-1)-.5,u=(a/(p-1)-.5)*r;e.push(2*l,2*c,2*u),t.push(s)}}return{positions:e,values:t}},[m,d,h,p]),v=(0,a.useMemo)(()=>{let e=new i.LoY;return e.setAttribute("position",new i.qtW(f,3)),e.setAttribute("value",new i.qtW(x,1)),e},[f,x]),g=new i.BKk({glslVersion:i.Wdf,uniforms:{pointSize:{value:l},cmap:{value:s},scalePoints:{value:c},scaleIntensity:{value:u}},vertexShader:"attribute float value;\r\nvarying float vValue;\r\nuniform float pointSize;\r\nuniform bool scalePoints;\r\nuniform float scaleIntensity;\r\n\r\nvoid main() {\r\n    vValue = value/255.;\r\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n    //If it is nan we just yeet it tf out of the screen space. LMAO I love this solution\r\n    float pointScale = pointSize/gl_Position.w;\r\n    pointScale = scalePoints ? pointScale*pow(vValue,scaleIntensity) : pointScale;\r\n    if (value == 255. || pointScale < 0.75){\r\n        gl_Position = vec4(2.0, 2.0, 2.0, 1.0);\r\n    }\r\n\r\n    gl_PointSize = pointScale;\r\n}\r\n",fragmentShader:"out vec4 Color;\r\n\r\nvarying float vValue;\r\nuniform sampler2D cmap;\r\n\r\nvoid main() {\r\n\r\n    vec4 color = texture(cmap, vec2(vValue, 0.5));\r\n    color.a = 1.;\r\n\r\n    Color = color;\r\n    \r\n}\r\n",depthWrite:!0,transparent:!0,blending:i.NTi,side:i.$EB});return(0,r.jsx)("points",{geometry:v,material:g})};var f=n(5634),x=n(6233),v=n(2757);function g(e){let{pointID:t,pointLoc:n,showPointInfo:i}=e,{plotDim:o,dimArrays:s,timeSeries:c,dimNames:u,dimUnits:m,plotUnits:d}=(0,a.useContext)(x.N),h=c[t],p=s[o][t],[f,v]=n,[g,y]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if(!i){let e=setTimeout(()=>{y(!1)},100);return()=>clearTimeout(e)}y(!0)},[i]),(0,r.jsx)(r.Fragment,{children:g&&(0,r.jsxs)("div",{className:"point-info",style:{left:"".concat(f,"px"),top:"".concat(v,"px")},children:["".concat(h.toFixed(2)).concat(d),(0,r.jsx)("br",{}),"".concat(u[o],": ").concat((0,l.SB)(p,m[o]),"       \n        ")]})})}function y(){let{coords:e}=(0,a.useContext)(x.N),[t,n]=(0,a.useState)(!1),i=(0,a.useRef)([40,115]),o=(0,a.useRef)([40,115]),[s,c]=(0,a.useState)([40,115]);function u(e){if(t){let t=i.current[0]-e.clientX,n=i.current[1]-e.clientY,r=Math.max(o.current[0]-t,10),a=Math.max(o.current[1]+n,14);c([Math.min(r,window.innerWidth-100),Math.min(a,window.innerHeight-100)])}}function m(){n(!1)}return(0,a.useEffect)(()=>(t&&(document.addEventListener("mousemove",u),document.addEventListener("mouseup",m)),()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",m)}),[t]),(0,r.jsx)(r.Fragment,{children:e&&"Default"!==e.first.name&&(0,r.jsxs)("div",{className:"plot-coords",style:{left:"".concat(s[0],"px"),bottom:"".concat(s[1],"px")},onPointerDown:function(e){i.current=[e.clientX,e.clientY],o.current=[...s],n(!0)},onPointerMove:u,onPointerUp:()=>n(!1),children:[(0,r.jsx)("b",{children:"".concat(e.first.name,": ")}),"".concat((0,l.SB)(e.first.loc,e.first.units)),(0,r.jsx)("br",{}),(0,r.jsx)("b",{children:"".concat(e.second.name,": ")}),"".concat((0,l.SB)(e.second.loc,e.second.units))]})})}function w(){let[e,t]=(0,a.useState)(0),[n,i]=(0,a.useState)([0,0]),[o,s]=(0,a.useState)(!1),[l,c]=(0,a.useState)(Math.round(window.innerHeight-.15*window.innerHeight-48)),[u,m]=(0,a.useState)(1),[d,p]=(0,a.useState)(1);return(0,r.jsxs)("div",{className:"plot-canvas",style:{position:"absolute",bottom:"48px",left:0,width:"100%",top:"".concat(l,"px"),background:"var(--background-plot)"},children:[(0,r.jsx)(g,{pointID:e,pointLoc:n,showPointInfo:o}),(0,r.jsx)(v.A,{height:l,setHeight:c}),(0,r.jsx)(v.gj,{scale:u,setScale:m}),(0,r.jsx)(v.LC,{scale:d,setScale:p}),(0,r.jsxs)(f.Hl,{orthographic:!0,camera:{position:[0,0,40]},frameloop:"demand",children:[(0,r.jsx)(h,{height:l,pointSetters:{setPointID:t,setPointLoc:i,setShowPointInfo:s},yScale:u,xScale:d}),(0,r.jsx)(j,{height:l,yScale:u,xScale:d})]}),(0,r.jsx)(y,{})]})}n(2786);var b=n(5641),S=n(1187);function j(e){let{colorTicks:t="white",tickSize:n=4,fontSize:i=14,showGrid:o=!0,gridOpacity:s=.5,height:c,yScale:d=1,xScale:h=1}=e,{camera:p}=(0,m.A)(),[f,x]=(0,a.useState)({left:0,right:0,top:0,bottom:0}),{coords:v,yRange:g,dimArrays:y,plotDim:w}=(0,a.useContext)(u.N),j=y[w],M=j.length,A=g[1]-g[0],N=(0,a.useMemo)(()=>{if(j){if(j.every(e=>"bigint"==typeof e)){let e=(0,l.lt)(v.plot.units),t=[];for(let n=0;n<j.length;n++){let r=Number(j[n])*e;t.push(new Date(r).toDateString())}return t}return j.map(e=>String(e))}},[j,v]),D=(0,a.useMemo)(()=>{let e=window.innerWidth,t=window.innerHeight-c-50;return{left:-e/2+p.position.x,right:e/2+p.position.x,top:t/2+p.position.y,bottom:-t/2+p.position.y}},[]),[P,z]=(0,a.useState)(p.zoom),B=(0,a.useMemo)(()=>{let e=1/p.zoom;return{tickSize:n*e,fontSize:i/e,labelOffset:n*e}},[p.zoom,n,i]);(0,m.C)(()=>{p.zoom!==P&&z(p.zoom);let e=window.innerWidth/p.zoom,t=(window.innerHeight-c-50)/p.zoom,n={left:-e/2+p.position.x,right:e/2+p.position.x,top:t/2+p.position.y,bottom:-t/2+p.position.y};JSON.stringify(f)!=JSON.stringify(n)&&x(n)});let F=(0,a.useRef)(null),_=(0,a.useRef)(null);(0,a.useEffect)(()=>(F.current&&clearTimeout(F.current),_.current&&(F.current=setTimeout(()=>{_.current&&_.current.reset()},100)),()=>{null!==F.current&&clearTimeout(F.current)}),[c]);let k=(f.top+f.bottom)/2,C=(f.left+f.right)/2;return(0,r.jsxs)("group",{children:[o&&(0,r.jsxs)(r.Fragment,{children:[Array.from({length:10},(e,n)=>{var i;if(0===n||9===n)return null;let o=+Math.round(f.left/1)+(Math.round(f.right/1)-Math.round(f.left/1))*(n/9),l=o/h/(D.right-D.left)+.5;return(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)("group",{position:[o,k,0],children:(0,r.jsxs)("line",{children:[(0,r.jsx)("bufferGeometry",{children:(0,r.jsx)("float32BufferAttribute",{attach:"attributes-position",args:[new Float32Array([0,f.top-k,0,0,f.bottom-k,0]),3]})}),(0,r.jsx)("lineDashedMaterial",{color:t,opacity:s,transparent:!0,dashSize:.5,gapSize:.5})]},"vgrid-".concat(n))}),(0,r.jsxs)("group",{position:[o,f.top,0],children:[(0,r.jsxs)("line",{children:[(0,r.jsx)("bufferGeometry",{children:(0,r.jsx)("float32BufferAttribute",{attach:"attributes-position",args:[new Float32Array([0,0,0,0,-B.tickSize,0]),3]})}),(0,r.jsx)("lineBasicMaterial",{color:t})]}),0!==n&&9!==n&&(0,r.jsx)(b.E,{position:[0,B.tickSize/4-B.labelOffset,0],fontSize:B.fontSize/P**2,color:t,anchorX:"center",anchorY:"top",children:null!=(i=null==N?void 0:N[Math.round(l*M-.5)])?i:""})]},"top-tick-".concat(n))]},"vert-group-".concat(n))}),Array.from({length:8},(e,n)=>{if(0===n||7===n)return null;let i=f.bottom+(f.top-f.bottom)*(n/7),o=i/d/(f.top-f.bottom)/P+.5;return(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)("group",{position:[C,i,0],children:(0,r.jsxs)("line",{children:[(0,r.jsx)("bufferGeometry",{children:(0,r.jsx)("float32BufferAttribute",{attach:"attributes-position",args:[new Float32Array([f.left-C,0,0,f.right-C,0,0]),3]})}),(0,r.jsx)("lineDashedMaterial",{color:t,opacity:s,transparent:!0,dashSize:0,gapSize:.5,linewidth:1})]})},"hgrid-".concat(n)),(0,r.jsxs)("group",{position:[f.right,i,0],children:[(0,r.jsxs)("line",{children:[(0,r.jsx)("bufferGeometry",{children:(0,r.jsx)("float32BufferAttribute",{attach:"attributes-position",args:[new Float32Array([0,0,0,-B.tickSize,0,0]),3]})}),(0,r.jsx)("lineBasicMaterial",{color:t})]}),0!==n&&7!==n&&(0,r.jsx)(b.E,{position:[-B.tickSize-B.labelOffset,0,0],fontSize:B.fontSize/P**2,color:t,anchorX:"right",anchorY:"middle",children:(g[0]+o*A).toFixed(1)})]},"right-tick-".concat(n))]},"vert-group-".concat(n))})]}),(0,r.jsx)(S.N,{ref:_,enableRotate:!1,enablePan:!0,enableZoom:!0,zoomSpeed:.85,maxDistance:500,maxZoom:20,minZoom:.5})]})}},5452:(e,t,n)=>{"use strict";n.a(e,async(e,r)=>{try{n.d(t,{default:()=>y});var a=n(2207),i=n(3612),o=n(5634),s=n(6287),l=n(1187),c=n(7474),u=n(6067),m=n(6023),d=n(5788),h=n(4938),p=n(5861),f=n(2757),x=n(6233),v=e([u]);function g(e){let{showLoading:t}=e;return(0,a.jsx)("div",{className:"messages",children:t&&(0,a.jsx)("div",{className:"loading",children:"Loading..."})})}u=(v.then?(await v)():v)[0],i.l2R.enabled=!0;let y=function(){let{variable:e,plotter:t,cmap:n,flipCmap:r}=(0,d._5)({variable:{value:"Default",options:u.Ee,label:"Select Variable"},plotter:{value:"volume",options:["volume","point-cloud"],label:"Select Plot Style"},cmap:{value:"Spectral",options:p.dl,label:"ColorMap"},flipCmap:{value:!1,label:"Invert Colors"}}),[v,y]=(0,m.useState)(null),[w,b]=(0,m.useState)(new i.Pq0(2,2,2)),[S,j]=(0,m.useState)({maxVal:1,minVal:-1}),[M,A]=(0,m.useState)((0,p.v6)()),[N,D]=(0,m.useState)([0]),[P,z]=(0,m.useState)(!1),[B,F]=(0,m.useState)(null),[_,k]=(0,m.useState)(null),[C,V]=(0,m.useState)([[0],[0],[0]]),[E,I]=(0,m.useState)(["default"]),[O,G]=(0,m.useState)(["Default"]),[W,Y]=(0,m.useState)(),[U,T]=(0,m.useState)(0),R=(0,m.useMemo)(()=>new u.Y5("https://s3.bgc-jena.mpg.de:9000/esdl-esdc-v3.0.2/esdc-16d-2.5deg-46x72x1440-3.0.2.zarr"),[]),[L,q]=(0,m.useState)(0),[H,J]=(0,m.useState)("Mean"),[X,K]=(0,m.useState)(!1),[Z,$]=(0,m.useState)(!1);(0,m.useEffect)(()=>{A((0,p.v6)(M,n,1,"#000000",0,r))},[n,M,r]),(0,m.useEffect)(()=>{if("Default"!=e)z(!0),R.GetArray(e).then(e=>{let[t,n,r]=(0,p.oW)({data:e.data,shape:e.shape});k(e),console.log("logging the shape since we will want to use it in the future for 2D vs 3D actions ".concat(n)),t instanceof i.GYF||t instanceof i.dYF?y(t):(console.error("Invalid texture type returned from ArrayToTexture"),y(null)),"object"==typeof r&&"maxVal"in r&&"minVal"in r&&j(r);let a=e.shape[1]/e.shape[2]*2;b(new i.Pq0(2,a,2)),z(!1)}),R.GetAttributes(e).then(e=>{F(e);let[t,n]=R.GetDimArrays();V(t);let r=[],a=[];for(let e of n)r.push(e.standard_name),a.push(e.units);I(r),G(a)});else{let e=(0,p.Fl)();(e instanceof i.dYF||e instanceof i.GYF)&&y(e),b(new i.Pq0(2,2,2)),F(null)}},[e]);let Q={coords:null!=W?W:{first:{name:"",loc:0,units:""},second:{name:"",loc:0,units:""},plot:{units:""}},plotDim:U,dimNames:E,dimUnits:O,dimArrays:C,plotUnits:B?B.units:"Default",yRange:[S.minVal,S.maxVal],timeSeries:N,scaling:{...S,colormap:M}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g,{showLoading:P}),(0,a.jsx)("div",{className:"canvas",children:(0,a.jsxs)(o.Hl,{shadows:!0,camera:{position:[-4.5,3,4.5],fov:50},frameloop:"demand",children:[(0,a.jsx)(s.o,{top:!0,position:[-1,0,1]}),"volume"==t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h._k,{volTexture:v,shape:w,colormap:M}),(0,a.jsx)(h.xP,{setters:{setTimeSeries:D,setPlotDim:T,setDimCoords:Y},values:{ZarrDS:R,shape:w,dimArrays:C,dimNames:E,dimUnits:O}})]}),"point-cloud"==t&&(0,a.jsx)(h.IE,{textures:{texture:v,colormap:M}}),(0,a.jsx)(l.N,{minPolarAngle:0,maxPolarAngle:Math.PI/2,enablePan:!1}),(0,a.jsx)(c.OH,{preset:"city"})]})}),B&&(0,a.jsx)(f.OS,{data:B}),(0,a.jsx)(x.N.Provider,{value:Q,children:"Default"!==e&&(0,a.jsx)(h.xn,{})}),(0,a.jsx)("button",{style:{position:"fixed",left:"4rem",top:"0.5rem"},onClick:()=>$(e=>!e)})]})};r()}catch(e){r(e)}})},5735:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(6023);let a={coords:{first:{name:"DefaultName1",loc:0,units:"meters"},second:{name:"DefaultName2",loc:1,units:"meters"},plot:{units:"pixels"}},plotDim:100,dimNames:["Default","Default","Default"],dimUnits:["Default","Default","Default"],dimArrays:[[0,1,2],[3,4,5]],plotUnits:"Default",yRange:[0,10],timeSeries:[1,2,3,4,5],scaling:{colormap:new(n(3612)).GYF,maxVal:100,minVal:0}},i=(0,r.createContext)(a)},5861:(e,t,n)=>{"use strict";n.d(t,{oW:()=>l,Fl:()=>c,v6:()=>o,dl:()=>i});var r=n(3612),a=n(8562);let i=["viridis","plasma","inferno","magma","Accent","Blues","CMRmap","twilight","tab10","gist_earth","cividis","Spectral","gist_stern","gnuplot","gnuplot2","ocean","turbo","GnBu","afmhot","cubehelix","hot","spring","terrain","winter","Wistia"];function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Spectral",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#000000",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=Array.from({length:255},(e,t)=>t/254),c=(l=s?l.reverse():l).map(e=>(0,a.md)(e,t,!1)),u=new Uint8Array((c.length+1)*4);for(let e=0;e<c.length;e++){let[t,r,a]=c[e];u[4*e]=t,u[4*e+1]=r,u[4*e+2]=a,u[4*e+3]=n}let m=function(e){let t=parseInt(e=e.replace(/^#/,""),16);return[t>>16&255,t>>8&255,255&t]}(i),d=4*c.length;if(u[d]=m[0],u[d+1]=m[1],u[d+2]=m[2],u[d+3]=o,e)return e.image.data.set(u),e.needsUpdate=!0,e;{let e=new r.GYF(u,c.length+1,1,r.GWd);return e.needsUpdate=!0,e}}function s(e){let t=e.shape,n=Array.from(e.data),[a,i,o]=t,s=n.reduce((e,t)=>isNaN(e)?t:isNaN(t)||e>t?e:t),l=n.reduce((e,t)=>isNaN(e)?t:isNaN(t)?e:e>t?t:e),c=new Uint8Array(n.map(e=>(e-l)/(s-l)).map(e=>isNaN(e)?255:254*e)),u=new r.dYF(c,o,i,a);return u.format=r.VT0,u.minFilter=r.hxR,u.magFilter=r.hxR,u.unpackAlignment=1,u.needsUpdate=!0,[u,{maxVal:s,minVal:l}]}function l(e){let t=e.shape,[n,a]=3==t.length?s(e):function(e){let t=e.shape,n=Array.from(e.data),a=t[0],i=t[1],o=n.reduce((e,t)=>isNaN(e)?t:isNaN(t)||e>t?e:t),s=n.reduce((e,t)=>isNaN(e)?t:isNaN(t)?e:e>t?t:e),l=new Uint8Array(n.map(e=>(e-s)/(o-s)).map(e=>255*e)),c=new r.GYF(l,a,i,r.VT0,r.OUM);return c.needsUpdate=!0,[c,{maxVal:o,minVal:s}]}(e);return[n,t,a]}function c(){let e=new Float32Array(1e3);for(let t=0;t<e.length;t++)e[t]=.2>Math.random()?NaN:Math.random();let[t,n]=s({data:e,shape:[10,10,10]});return t}},6067:(e,t,n)=>{"use strict";n.a(e,async(e,r)=>{try{n.d(t,{Ee:()=>m,Y5:()=>e});var a=n(3677),i=n(9773),o=n(6198),s=n(4911),l=n(9501),c=n(7430);async function u(e){let t=a.x(new i.A(e)),n=await t.then(e=>o.h(e,{kind:"group"}));var r="contents"in n.store?n.store.contents():{};let s=[];for(let e of Object.keys(r)){let t=r[e];t.path&&t.path.length>1&&"array"===t.kind&&s.push(t.path.substring(1))}return s}class e{async GetArray(e){if(this.variable=e,this.cache.has(e))return this.cache.get(e);let t=a.x(new i.A(this.storePath)),n=await t.then(e=>o.h(e,{kind:"group"})),r=await o.h(n.resolve(e),{kind:"array"});if(r.is("number")||r.is("bigint")){let t,n=await s.Jt(r);if(n.data instanceof BigInt64Array||n.data instanceof BigUint64Array)throw Error("BigInt arrays are not supported for conversion to Float32Array.");return t=new Float32Array(n.data),this.cache.set(e,n),{data:t,shape:n.shape,dtype:r.dtype}}throw Error("Unsupported data type: Only numeric arrays are supported. Got: ".concat(r.dtype))}async GetAttributes(e){let t="".concat(e,"_meta");if(this.cache.has(t))return this.cache.get(t);let n=a.x(new i.A(this.storePath)),r=await n.then(e=>o.h(e,{kind:"group"})),l=(await o.h(r.resolve(e),{kind:"array"})).attrs;this.cache.set(t,l);let c=[];for(let e of l._ARRAY_DIMENSIONS){if(!this.cache.has(e)){let t=await o.h(r.resolve(e),{kind:"array"}).then(e=>s.Jt(e)),n=await o.h(r.resolve(e),{kind:"array"}).then(e=>e.attrs);this.cache.set(e,t.data),this.cache.set("".concat(e,"_meta"),n)}c.push(e)}return this.dimNames=c,l}GetDimArrays(){let e=[],t=[];for(let n of this.dimNames)e.push(this.cache.get(n)),t.push(this.cache.get("".concat(n,"_meta")));return[e,t]}async GetTimeSeries(e){let{uv:t,normal:n}=e;if(!this.cache.has(this.variable))return[0];let{data:r,shape:a,stride:i}=this.cache.get(this.variable),o=(0,c.jT)({normal:n,uv:t}).map((e,t)=>null===e||null===a[t]?null:Math.round(e*a[t])),s=o.indexOf(null),l=i[s],u=null==o[0]?0:i[0]*o[0],m=null==o[1]?0:i[1]*o[1],d=null==o[2]?0:i[2]*o[2],h=[];for(let e=0;e<a[s];e++){let t=e*l+u+m+d;h.push(r[t])}return h}constructor(e){this.storePath=e,this.variable="Default",this.cache=new l.A({maxSize:2e3}),this.dimNames=["","",""]}}let m=await u("https://s3.bgc-jena.mpg.de:9000/esdl-esdc-v3.0.2/esdc-16d-2.5deg-46x72x1440-3.0.2.zarr");r()}catch(e){r(e)}},1)},6233:(e,t,n)=>{"use strict";n.d(t,{N:()=>r.N});var r=n(5735)},7430:(e,t,n)=>{"use strict";function r(e){if("Default"===e)return console.log("Aborting?"),1;if(!e||"string"!=typeof e||""===e.trim())return 1;let t=e.match(/^(\w+)\s+since\s+(.+)$/i);if(!t)throw Error('Invalid time unit format: expected "<unit> since <date>", got "'.concat(e,'"'));let[n,r,a]=t,i=r.toLowerCase(),o={millisecond:1,milliseconds:1,second:1e3,seconds:1e3,minute:6e4,minutes:6e4,hour:36e5,hours:36e5,day:864e5,days:864e5},s=i.endsWith("s")?i.slice(0,-1):i,l=void 0!==o[i]?i:s;if(!(l in o))throw Error('Unsupported time unit: "'.concat(r,'". Supported units: ').concat(Object.keys(o).join(", ")));return o[l]}function a(e,t){if(!t)return e;if("bigint"==typeof e){let n=r(t);return new Date(Number(e)*n).toDateString()}return t.match(/(degree|degrees|deg|°)/i)?"".concat(e.toFixed(2),"\xb0"):e.toFixed(2)}function i(e){let{normal:t,uv:n}=e;switch(!0){case 1===t.z:return[null,n.y,n.x];case -1===t.z:return[null,n.y,1-n.x];case 1===t.x:return[n.x,n.y,null];case -1===t.x:return[1-n.x,n.y,null];case 1===t.y:return[1-n.y,null,n.x];default:return[0,0,0]}}n.d(t,{SB:()=>a,jT:()=>i,lt:()=>r})}},e=>{var t=t=>e(e.s=t);e.O(0,[913,907,970,667,195,984,269,420,7,757,80,448,358],()=>t(4394)),_N_E=e.O()}]);